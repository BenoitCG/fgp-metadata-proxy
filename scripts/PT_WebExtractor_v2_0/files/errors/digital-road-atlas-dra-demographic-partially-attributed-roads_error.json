ERROR: Traceback (most recent call last):
  File "C:\FGP\Development\PT_WebExtractor\scripts\BC_extractor.py", line 881, in extract_catalogue
    pt_csv.add('Metadata URL', ds_cat_url)
NameError: global name 'ds_cat_url' is not defined


{
    "help": "Shows the package info with the given id. Param : id", 
    "result": {
        "author": "d0716cb8-7eb5-4d43-9f57-6022096fd79f", 
        "author_email": null, 
        "contacts": [
            {
                "branch": "e51a8106-11c7-4436-a967-7cee18bfb159", 
                "delete": "0", 
                "email": "Carol.Ogborne@gov.bc.ca", 
                "name": "Carol Ogborne", 
                "organization": "3275286d-4ec9-422a-817f-ab0e232eddfe", 
                "role": "pointOfContact"
            }, 
            {
                "branch": "e51a8106-11c7-4436-a967-7cee18bfb159", 
                "delete": "0", 
                "email": "Carol.Ogborne@gov.bc.ca", 
                "name": "Carol Ogborne", 
                "organization": "3275286d-4ec9-422a-817f-ab0e232eddfe", 
                "private": "Display", 
                "role": "pointOfContact"
            }
        ], 
        "creator_user_id": "d0716cb8-7eb5-4d43-9f57-6022096fd79f", 
        "data_quality": "", 
        "dates": [
            {
                "date": "2017-09-30", 
                "type": "Published"
            }
        ], 
        "details": [
            {
                "column_comments": "DIGITAL ROAD ATLAS LINE ID is a unique numeric road segment identifier e.g. 453567.", 
                "column_name": "DIGITAL_ROAD_ATLAS_LINE_ID", 
                "data_precision": "10", 
                "data_type": "NUMBER", 
                "short_name": "DGTLRDTLSL"
            }, 
            {
                "column_comments": "FEATURE TYPE is the feature type classification of the road, e.g. bridge, dam, ferry route, etc.", 
                "column_name": "FEATURE_TYPE", 
                "data_precision": "12", 
                "data_type": "VARCHAR2", 
                "short_name": "FTRTP"
            }, 
            {
                "column_comments": "HIGHWAY EXIT NUMBER is a numeric or alpha-numeric identifier assigned to a road segment that allows egress from a segment designated as a highway, e.g. 5a.", 
                "column_name": "HIGHWAY_EXIT_NUMBER", 
                "data_precision": "6", 
                "data_type": "VARCHAR2", 
                "short_name": "HGHWXTNMBR"
            }, 
            {
                "column_comments": "HIGHWAY ROUTE NUMBER is the designated Highways and Arterials numbers, delimited by a plus sign, e.g. 1+5+97.", 
                "column_name": "HIGHWAY_ROUTE_NUMBER", 
                "data_precision": "12", 
                "data_type": "VARCHAR2", 
                "short_name": "HGHWRTNMBR"
            }, 
            {
                "column_comments": "SEGMENT LENGTH 2D is the 2D road segment length in meters, e.g. 234.456.", 
                "column_name": "SEGMENT_LENGTH_2D", 
                "data_precision": "10", 
                "data_type": "NUMBER", 
                "short_name": "SGMNTLNGTH"
            }, 
            {
                "column_comments": "SEGMENT LENGTH 3D is the 3D road segment length in meters, e.g. 123.456.", 
                "column_name": "SEGMENT_LENGTH_3D", 
                "data_precision": "10", 
                "data_type": "NUMBER", 
                "short_name": "SGMNTLNGT1"
            }, 
            {
                "column_comments": "ROAD NAME ALIAS1 is the first full alias name, e.g. Trans-Canada Hwy E.", 
                "column_name": "ROAD_NAME_ALIAS1", 
                "data_precision": "70", 
                "data_type": "VARCHAR2", 
                "short_name": "RDNMLS1"
            }, 
            {
                "column_comments": "ROAD NAME ALIAS1 ID is a numeric identifier for the first alias name, e.g. 123456.", 
                "column_name": "ROAD_NAME_ALIAS1_ID", 
                "data_precision": "8", 
                "data_type": "NUMBER", 
                "short_name": "RDNMLS1D"
            }, 
            {
                "column_comments": "ROAD NAME ALIAS2 is the second full alias name, e.g. Hwy 1.", 
                "column_name": "ROAD_NAME_ALIAS2", 
                "data_precision": "70", 
                "data_type": "VARCHAR2", 
                "short_name": "RDNMLS2"
            }, 
            {
                "column_comments": "ROAD NAME ALIAS2 ID is a numeric identifier for the second alias name, e.g. 123456.", 
                "column_name": "ROAD_NAME_ALIAS2_ID", 
                "data_precision": "8", 
                "data_type": "NUMBER", 
                "short_name": "RDNMLS2D"
            }, 
            {
                "column_comments": "ROAD NAME ALIAS3 is the third full alias name, e.g Hwy 5.", 
                "column_name": "ROAD_NAME_ALIAS3", 
                "data_precision": "70", 
                "data_type": "VARCHAR2", 
                "short_name": "RDNMLS3"
            }, 
            {
                "column_comments": "ROAD NAME ALIAS3 ID is a numeric identifier for the third alias name, e.g. 123456.", 
                "column_name": "ROAD_NAME_ALIAS3_ID", 
                "data_precision": "8", 
                "data_type": "NUMBER", 
                "short_name": "RDNMLS3D"
            }, 
            {
                "column_comments": "ROAD NAME ALIAS4 is the fourth full alias name, e.g. Hwy 97.", 
                "column_name": "ROAD_NAME_ALIAS4", 
                "data_precision": "70", 
                "data_type": "VARCHAR2", 
                "short_name": "RDNMLS4"
            }, 
            {
                "column_comments": "ROAD NAME ALIAS4 ID is a numeric identifier for the fourth alias name, e.g. 123456.", 
                "column_name": "ROAD_NAME_ALIAS4_ID", 
                "data_precision": "8", 
                "data_type": "NUMBER", 
                "short_name": "RDNMLS4D"
            }, 
            {
                "column_comments": "ROAD NAME FULL is the complete name for the road made up of the concatenation of the individual road name components, e.g. Elk Valley Hwy.", 
                "column_name": "ROAD_NAME_FULL", 
                "data_precision": "70", 
                "data_type": "VARCHAR2", 
                "short_name": "RDNMFLL"
            }, 
            {
                "column_comments": "ROAD NAME ID is the unique ID for each distinct full road name, e.g. 60657.", 
                "column_name": "ROAD_NAME_ID", 
                "data_precision": "8", 
                "data_type": "NUMBER", 
                "short_name": "RDNMD"
            }, 
            {
                "column_comments": "ROAD SURFACE is the road surface type, e.g boat, decommissioned, loose, overgrown, paved, rough, unknown.", 
                "column_name": "ROAD_SURFACE", 
                "data_precision": "15", 
                "data_type": "VARCHAR2", 
                "short_name": "RDSRFC"
            }, 
            {
                "column_comments": "ROAD CLASS is the navigational road classification, e.g alleyway, arterial, collector, etc.", 
                "column_name": "ROAD_CLASS", 
                "data_precision": "12", 
                "data_type": "VARCHAR2", 
                "short_name": "ROAD_CLASS"
            }, 
            {
                "column_comments": "NUMBER OF LANES is the total number of lanes of through traffic on both sides of the segment, e.g. 2.", 
                "column_name": "NUMBER_OF_LANES", 
                "data_precision": "2", 
                "data_type": "NUMBER", 
                "short_name": "NMBRFLNS"
            }, 
            {
                "column_comments": "NODE FROM ID is the start network node topology identifier, e.g. 299876.", 
                "column_name": "NODE_FROM_ID", 
                "data_precision": "8", 
                "data_type": "NUMBER", 
                "short_name": "NDFRMD"
            }, 
            {
                "column_comments": "NODE TO ID is the end network node topology identifier, e.g. 299877.", 
                "column_name": "NODE_TO_ID", 
                "data_precision": "8", 
                "data_type": "NUMBER", 
                "short_name": "NODE_TO_ID"
            }, 
            {
                "column_comments": "DATA SUPPLIER is the data supplier company or organization . This can be provincial agencies including Ministry of Environment, Lands and Parks, local governments, 911 service providers and Utilities, e.g. ministryOfEnvironmentLandsParks.", 
                "column_name": "DATA_SUPPLIER", 
                "data_precision": "50", 
                "data_type": "VARCHAR2", 
                "short_name": "DTSPPLR"
            }, 
            {
                "column_comments": "SUPPLIER DETAIL is additional details regarding the data supplying organization, e.g geographicDataBC.", 
                "column_name": "SUPPLIER_DETAIL", 
                "data_precision": "50", 
                "data_type": "VARCHAR2", 
                "short_name": "SPPLRDTL"
            }, 
            {
                "column_comments": "GEOMETRY CAPTURE TECHNIQUE is the data capture technique or positioning method, e.g cadastre, differentialGPS, orthoPhotography, etc.", 
                "column_name": "GEOMETRY_CAPTURE_TECHNIQUE", 
                "data_precision": "30", 
                "data_type": "VARCHAR2", 
                "short_name": "GMTRCPTRTC"
            }, 
            {
                "column_comments": "DATA CAPTURE DATE is the Date of data capture in the format YYYYMMDD e.g. 20110623.", 
                "column_name": "DATA_CAPTURE_DATE", 
                "data_precision": "7", 
                "data_type": "DATE", 
                "short_name": "DTCPTRDT"
            }, 
            {
                "column_comments": "FEATURE CODE contains a value based on the Canadian Council of Surveys and Mapping''s (CCSM) system for classification of geographic features.", 
                "column_name": "FEATURE_CODE", 
                "data_precision": "10", 
                "data_type": "VARCHAR2", 
                "short_name": "FTRCD"
            }, 
            {
                "column_comments": "GEOMETRY is the column used to reference the spatial coordinates defining the feature. ", 
                "column_name": "GEOMETRY", 
                "data_precision": "1", 
                "data_type": "SDO_GEOMETRY", 
                "short_name": "GEOMETRY"
            }, 
            {
                "column_comments": "OBJECTID is a required attribute of feature classes and object classes in a geodatabase. ", 
                "column_name": "OBJECTID", 
                "data_precision": "38", 
                "data_type": "NUMBER", 
                "short_name": "OBJECTID"
            }, 
            {
                "column_comments": "SE_ANNO_CAD_DATA is a binary column used by spatial tools to store annotation, curve features and CAD data when using the SDO_GEOMETRY storage data type. ", 
                "column_name": "SE_ANNO_CAD_DATA", 
                "data_precision": "4000", 
                "data_type": "BLOB"
            }, 
            {
                "column_comments": "FEATURE_LENGTH_M is the system calculated length or perimeter of a geometry in meters", 
                "column_name": "FEATURE_LENGTH_M", 
                "data_precision": "19", 
                "data_type": "NUMBER"
            }
        ], 
        "download_audience": "Public", 
        "east_bound_longitude": "-113.5", 
        "edc_state": "PUBLISHED", 
        "groups": [], 
        "id": "c4935326-27cc-4324-8a2b-61685d3e9ac4", 
        "iso_topic_string": "economy", 
        "isopen": false, 
        "layer_name": "DRA_DIGITAL_ROAD_ATLAS", 
        "license_id": "22", 
        "license_title": "Access Only", 
        "license_url": "http://www2.gov.bc.ca/gov/content/home/copyright", 
        "lineage_statement": "", 
        "link_to_imap": "", 
        "maintainer": null, 
        "maintainer_email": null, 
        "metadata_character_set": "utf8", 
        "metadata_created": "2014-12-11T05:11:08.895889", 
        "metadata_language": "eng", 
        "metadata_modified": "2018-11-27T19:10:30.429395", 
        "metadata_standard_name": "North American Profile of ISO 19115-1:2014 - Geographic information - Metadata (NAP-Metadata)", 
        "metadata_standard_version": "n/a", 
        "metadata_visibility": "Public", 
        "more_info": [
            {
                "delete": "0", 
                "link": ""
            }
        ], 
        "name": "digital-road-atlas-dra-demographic-partially-attributed-roads", 
        "north_bound_latitude": "60.0", 
        "notes": "Digital Road Atlas Demographic Partially-Attributed Roads (DGTL ROAD ATLAS DPAR SP) provides partial information about roads in British Columbia. This data set represents the public data that is available for the Digital Road Atlas.  For more information on the DRA program please visit the [DRA info page](http://www2.gov.bc.ca/gov/content?id=21FFEC94B0AD40818D2D2AF06D522714)\r\n\r\nThis dataset is updated on the 6th of every month to the warehouse", 
        "num_resources": 3, 
        "num_tags": 1, 
        "object_name": "WHSE_BASEMAPPING.DRA_DGTL_ROAD_ATLAS_DPAR_SP", 
        "object_short_name": "RA_DPAR", 
        "odsi_uid": "177805", 
        "org": "3275286d-4ec9-422a-817f-ab0e232eddfe", 
        "organization": {
            "approval_status": "approved", 
            "created": "2014-12-10T15:05:03.074998", 
            "description": "__GeoBC__ creates and manages geospatial information and products to help better manage natural resources in British Columbia. GeoBC also offers consultation services across all natural resource sector agencies.\r\n\r\n__GeoBC__ has four areas of focus directly tied to natural resource business functions:\r\n* Creating and maintaining a standard set of base spatial data that is open and accessible\r\n* Providing direction and assurance for provincial land registries\r\n* Offering Crown land and resource research expertise to other government agencies\r\n* Delivering a service for custom solutions to natural resource business issues", 
            "full_title": "Ministry of Forests, Lands, Natural Resource Operations and Rural Development, GeoBC", 
            "id": "e51a8106-11c7-4436-a967-7cee18bfb159", 
            "image_url": "2018-10-25-235213.2962110UttD3d9400x400.jpg", 
            "is_organization": true, 
            "name": "geobc", 
            "revision_id": "061e0717-6838-4a42-a965-52b0f14736b0", 
            "state": "active", 
            "title": "GeoBC", 
            "type": "organization"
        }, 
        "owner_org": "e51a8106-11c7-4436-a967-7cee18bfb159", 
        "preview_image_url": "", 
        "preview_latitude": "53.917500000000004", 
        "preview_longitude": "-122.7604", 
        "preview_map_service_url": "http://openmaps.gov.bc.ca/mapserver/base3", 
        "preview_zoom_level": "15", 
        "private": false, 
        "purpose": "", 
        "record_archive_date": "", 
        "record_create_date": "2013-02-27", 
        "record_last_modified": "2018-11-27", 
        "record_publish_date": "2013-02-27", 
        "relationships_as_object": [], 
        "relationships_as_subject": [], 
        "replacement_record": "", 
        "resource_status": "onGoing", 
        "resources": [
            {
                "cache_last_updated": null, 
                "cache_url": null, 
                "created": "2014-12-10T21:11:08.917098", 
                "datastore_active": false, 
                "description": "", 
                "edc_resource_type": "Data", 
                "format": "zip", 
                "hash": "", 
                "id": "b04b3624-a3d4-4e50-9c21-31b2e05f6892", 
                "last_modified": null, 
                "mimetype": null, 
                "mimetype_inner": null, 
                "name": "Digital Road Atlas (DRA) - Demographic Partially-Attributed Roads - Custom Download", 
                "package_id": "c4935326-27cc-4324-8a2b-61685d3e9ac4", 
                "position": 0, 
                "projection_name": "EPSG_4326 - WGS84 - World Geodetic System 1984", 
                "resource_storage_access_method": "Indirect Access", 
                "resource_storage_location": "BCGW Data Store", 
                "resource_type": null, 
                "resource_update_cycle": "monthly", 
                "revision_id": "1141ca64-b595-428e-a10d-8b5420b09bba", 
                "size": null, 
                "state": "active", 
                "tracking_summary": {
                    "recent": 8, 
                    "total": 672
                }, 
                "url": "https://apps.gov.bc.ca/pub/dwds/addProductsFromExternalApplication.do?productTypeId=0&productId=15221", 
                "url_type": null
            }, 
            {
                "cache_last_updated": null, 
                "cache_url": null, 
                "created": "2014-12-10T21:11:08.917110", 
                "data_collection_end_date": "", 
                "data_collection_start_date": "", 
                "datastore_active": false, 
                "description": "", 
                "edc_resource_type": "Data", 
                "format": "zip", 
                "hash": "", 
                "id": "b7b7f8c8-d1d9-47bb-99e6-5bae7a408c51", 
                "last_modified": null, 
                "mimetype": null, 
                "mimetype_inner": null, 
                "name": "DRA_Public", 
                "package_id": "c4935326-27cc-4324-8a2b-61685d3e9ac4", 
                "position": 1, 
                "projection_name": "EPSG_4326 - WGS84 - World Geodetic System 1984", 
                "resource_storage_access_method": "Direct Access", 
                "resource_storage_location": "External", 
                "resource_type": null, 
                "resource_update_cycle": "monthly", 
                "revision_id": "1141ca64-b595-428e-a10d-8b5420b09bba", 
                "size": null, 
                "state": "active", 
                "supplemental_info": "", 
                "tracking_summary": {
                    "recent": 24, 
                    "total": 1265
                }, 
                "url": "ftp://ftp.geobc.gov.bc.ca/sections/outgoing/bmgs/DRA_Public", 
                "url_type": null
            }, 
            {
                "cache_last_updated": null, 
                "cache_url": null, 
                "created": "2017-10-04T23:47:09.953152", 
                "data_collection_end_date": "", 
                "data_collection_start_date": "", 
                "datastore_active": false, 
                "description": "Digital Road Atlas Data Dictionary", 
                "edc_resource_type": "Reports", 
                "format": "pdf", 
                "hash": "", 
                "id": "7205b635-e14f-400e-9016-f6b8b6e60b8c", 
                "last_modified": "2017-10-04T23:47:09.297952", 
                "mimetype": "application/pdf", 
                "mimetype_inner": null, 
                "name": "DGTL_ROAD_ATLAS Public Delivery Data Dictionary", 
                "package_id": "c4935326-27cc-4324-8a2b-61685d3e9ac4", 
                "position": 2, 
                "projection_name": "EPSG_3005 - NAD83 BC Albers", 
                "resource_storage_access_method": "Direct Access", 
                "resource_storage_location": "Catalogue Data Store", 
                "resource_type": null, 
                "resource_update_cycle": "monthly", 
                "revision_id": "1141ca64-b595-428e-a10d-8b5420b09bba", 
                "size": 192409, 
                "state": "active", 
                "supplemental_info": "", 
                "tracking_summary": {
                    "recent": 2, 
                    "total": 42
                }, 
                "url": "https://catalogue.data.gov.bc.ca/dataset/c4935326-27cc-4324-8a2b-61685d3e9ac4/resource/7205b635-e14f-400e-9016-f6b8b6e60b8c/download/dgtlroadatlas-public-delivery-data-dictionary.pdf", 
                "url_type": "upload"
            }
        ], 
        "retention_expiry_date": "", 
        "revision_id": "c389c935-9752-4237-afd8-139c11ff8699", 
        "sector": "Natural Resources", 
        "security_class": "LOW-PUBLIC", 
        "source_data_path": "", 
        "south_bound_latitude": "48.0", 
        "spatial": "{\"type\": \"Polygon\", \"coordinates\": [[[-139.5, 48.0], [-139.5, 60.0], [-113.5, 60.0], [-113.5, 48.0], [-139.5, 48.0]]]}", 
        "state": "active", 
        "sub_org": "e51a8106-11c7-4436-a967-7cee18bfb159", 
        "tags": [
            {
                "display_name": "provincial digital road atlas", 
                "id": "c96bf1c6-04e9-4300-b845-96855edee3d1", 
                "name": "provincial digital road atlas", 
                "state": "active", 
                "vocabulary_id": null
            }
        ], 
        "title": "Digital Road Atlas (DRA) - Demographic Partially-Attributed Roads", 
        "tracking_summary": {
            "recent": 34, 
            "total": 3000
        }, 
        "type": "Geographic", 
        "url": null, 
        "version": null, 
        "view_audience": "Public", 
        "west_bound_longitude": "-139.5"
    }, 
    "success": true
}